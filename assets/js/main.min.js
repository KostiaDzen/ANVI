const shop=document.querySelector(".shop"),popap=document.querySelector(".popap"),popapContent=document.querySelector(".popap-content"),popapGoods=document.querySelector(".popap-goods"),popapClose=document.querySelector(".popap-close"),popapOrder=document.querySelector(".popapOrder"),popapOrderContent=document.querySelector(".popapOrder-content"),popapOrderClose=document.querySelector(".popapOrder-close"),popapBtn=document.querySelector(".popap-btn"),popapOrderFormBtn=document.querySelector(".popapOrder-form--btn"),popapThanks=document.querySelector(".popapThanks"),popapThanksContent=document.querySelector(".popapThanks-content"),popapThanksBtn=document.querySelector(".popapThanks-btn"),token="5914364148:AAEoU50-ORXLpVdx6_ioN7YnCERjRUM9qck",chat_id="-940073457",API=`https://api.telegram.org/bot${token}/sendMessage`;var productsBtn=document.querySelectorAll(".goods-item--box"),cartItems=document.querySelectorAll(".popap-goods--item"),productsBtn0=document.querySelectorAll('[data-number="0"]'),productsBtn12=document.querySelectorAll('[data-number="12"]'),quantity=document.querySelector(".quantity"),fullSum=document.querySelector(".total-sum"),idItems=[];const swiper=new Swiper(".swiper",{spaceBetween:20,slidesPerView:3,grabCursor:!0,navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}}),answers=()=>{document.querySelectorAll(".swiper-slide--item").forEach(o=>{o.addEventListener("mouseover",e=>{var t=o.getAttribute("data-slide");document.querySelector(t).classList.add("active")}),o.addEventListener("mouseout",e=>{var t=o.getAttribute("data-slide");document.querySelector(t).classList.remove("active")})})},observer=new IntersectionObserver(e=>{e.forEach(t=>{t.isIntersecting&&document.querySelectorAll(".link").forEach(e=>{e.classList.toggle("active",e.getAttribute("href").replace("#","")===t.target.id)})})},{threshold:.7}),links=(document.querySelectorAll(".section").forEach(e=>{observer.observe(e)}),()=>{for(let t of document.querySelectorAll('a[href*="#"]'))t.addEventListener("click",e=>{e.preventDefault();e=t.getAttribute("href");document.querySelector(""+e).scrollIntoView({behavior:"smooth",block:"center"})})}),downList=()=>{var e=document.querySelectorAll(".content--title");let a=document.querySelectorAll(".content--text"),r=document.querySelectorAll(".arrow");r[0].style.transform="rotate(90deg)",e.forEach(s=>{s.addEventListener("click",e=>{r.forEach(e=>{e.style.transform="rotate(0deg)"});var t=s.getAttribute("data-tab"),o=document.querySelector(t),t=t.toString().slice(-1);a.forEach(e=>{e.style.maxHeight=null,e.classList.remove("active")}),o.classList.add("active"),o.style.maxHeight=o.scrollHeight+"px",r[parseInt(t)-1].style.transform="rotate(90deg)"})})},popapFuction=o=>{o=document.querySelector(".quantity"),shop.addEventListener("click",()=>{0<parseInt(o.textContent)?(popap.classList.add("active"),popapContent.classList.add("active")):(popap.classList.remove("active"),popapContent.classList.remove("active"))}),popapClose.addEventListener("click",()=>{popap.classList.remove("active"),popapContent.classList.remove("active")}),popapOrderClose.addEventListener("click",()=>{popapOrder.classList.remove("active"),popapOrderContent.classList.remove("active")}),popapOrderFormBtn.addEventListener("click",()=>{popapOrder.classList.remove("active"),popapOrderContent.classList.remove("active")}),popapBtn.addEventListener("click",()=>{popap.classList.remove("active"),popapContent.classList.remove("active"),popapOrder.classList.add("active"),popapOrderContent.classList.add("active")}),popapThanksBtn.addEventListener("click",()=>{popapThanks.classList.remove("active"),popapThanksContent.classList.remove("active")}),window.addEventListener("click",e=>{var t,e=e.target;e===popap&&(popap.classList.remove("active"),popapContent.classList.remove("active")),e===popapOrder&&(popapOrder.classList.remove("active"),popapOrderContent.classList.remove("active")),0==parseInt(o.textContent)&&(popap.classList.remove("active"),popapContent.classList.remove("active")),"plus"==e.dataset.action&&(t=e.closest(".popap-goods--item").querySelector(".popap-goods--count_num"),plus(t),calcPrice(),updateStorage()),"minus"==e.dataset.action&&(t=e.closest(".popap-goods--item").querySelector(".popap-goods--count_num"),minus(t),calcPrice(),updateStorage())})},generateCartProduct=(e,t,o,s)=>`
    <div data-id="${e}" class="popap-goods--item">
        <img class="popap-goods--close" src="assets/img/sprite/Close.svg" alt="Close">
        <div class="popap-goods--border">
            <img src="${t}" alt="goods" class="popap-goods--img">
            <span class="popap-goods--title">${o}</span>
            <div class="popap-goods--count">
                <span class="popap-goods--count_num">1</span>
                <svg class="up_down up">
                    <use data-action="plus" class="popap-goods--count_up" xlink:href="assets/img/sprite/symbol/sprite.svg#Up_down"></use>
                </svg>
                <svg class="up_down down">
                    <use data-action="minus" class="popap-goods--count_down" xlink:href="assets/img/sprite/symbol/sprite.svg#Up_down"></use>
                </svg>
            </div>
            <div class="popap-goods--price">
                <span class="popap-price">${s}</span> грн.
            </div>
        </div>
    </div>
    `,printQuantity=()=>{quantity=document.querySelector(".quantity");var e=document.querySelector(".popap-goods").children.length;0<(quantity.textContent=e)?quantity.classList.add("active"):quantity.classList.remove("active")},Check=()=>{productsBtn=document.querySelectorAll(".goods-item--box"),productsBtn0=document.querySelectorAll('[data-number="0"]'),productsBtn12=document.querySelectorAll('[data-number="12"]'),productsBtn.forEach(t=>{t.addEventListener("click",e=>{e.target.classList.contains("check")||(t.classList.add("check"),"0"===t.getAttribute("data-number")&&productsBtn0.forEach(e=>{e.classList.add("check")}),"12"===t.getAttribute("data-number")&&productsBtn12.forEach(e=>{e.classList.add("check")}));e=e.currentTarget.closest(".goods-item"),e={id:e.dataset.id,img:e.querySelector(".goods-item--img").getAttribute("src"),title:e.querySelector(".goods-item--title").textContent,price:parseInt(e.querySelector(".price").textContent)};popapGoods.querySelector(`[data-id="${e.id}"]`)||(document.querySelector(".popap-goods").insertAdjacentHTML("afterbegin",generateCartProduct(e.id,e.img,e.title,e.price)),printQuantity(),calcPrice(),updateStorage(),idItems.push(parseInt(e.id)),localStorage.setItem("id",JSON.stringify(idItems)))})})},deleteProducts=e=>{var t=e.dataset.id,e=("12"===t||"0"===t?document.querySelectorAll(`.goods-item[data-id="${t}"]`).forEach(e=>{e.querySelector(".goods-item--box").classList.remove("check")}):document.querySelector(`.goods-item[data-id="${t}"]`).querySelector(".goods-item--box").classList.remove("check"),e.remove(),localStorage.getItem("id")),e=JSON.parse(e),t=(localStorage.removeItem("id"),e.indexOf(parseInt(t)));e.splice(t,1),localStorage.setItem("id",JSON.stringify(e)),calcPrice(),printQuantity(),updateStorage()},basket=()=>{popapGoods.addEventListener("click",e=>{e.target.classList.contains("popap-goods--close")&&deleteProducts(e.target.closest(".popap-goods--item"))})},plus=e=>{e.textContent=++e.textContent},minus=e=>{1<parseInt(e.textContent)&&(e.textContent=--e.textContent)},calcPrice=()=>{cartItems=document.querySelectorAll(".popap-goods--item");let o=0;cartItems.forEach(e=>{var t=e.querySelector(".popap-goods--count_num"),e=e.querySelector(".popap-price"),t=parseInt(t.textContent)*parseInt(e.textContent);o+=t}),(fullSum=document.querySelector(".total-sum")).textContent=o};async function getStars(){var e=await(await fetch("assets/json/shampoo.json")).json(),t=await(await fetch("assets/json/news.json")).json(),o=document.querySelector(".anvi-left--goods");o.innerHTML+=`
        <div data-id="12" class="goods-item border">
            <img src=${t[1].url} alt="soap" class="goods-item--img">
            <h4 class="goods-item--title top">${t[1].title}</h4>
            <p class="goods-item--text top">${t[1].description}</p>
            <p class="goods-item--price"><span class="price">${t[1].price}</span> <span>грн.</span></p>
            <svg class="plus top">
                <use data-number="12" xlink:href="assets/img/sprite/symbol/sprite.svg#PlusCircle" class="goods-item--box"></use>
            </svg>
            <svg width="60" height="60" viewBox="0 0 60 60" fill="none" id="CheckCircle" xmlns="http://www.w3.org/2000/svg" class="top">
                <path d="M40.3125 24.375L26.5547 37.5L19.6875 30.9375" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M30 52.5C42.4264 52.5 52.5 42.4264 52.5 30C52.5 17.5736 42.4264 7.5 30 7.5C17.5736 7.5 7.5 17.5736 7.5 30C7.5 42.4264 17.5736 52.5 30 52.5Z" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
    `,o.innerHTML+=`
        <div data-id="0" class="goods-item">
            <img src=${e[0].url} alt="soap" class="goods-item--img">
            <h4 class="goods-item--title top">${e[0].title}</h4>
            <p class="goods-item--text top">${e[0].description}</p>
            <p class="goods-item--price"><span class="price">${e[0].price}</span> <span>грн.</span></p>
            <svg class="plus top">
                <use data-number="0" xlink:href="assets/img/sprite/symbol/sprite.svg#PlusCircle" class="goods-item--box"></use>
            </svg>
            <svg width="60" height="60" viewBox="0 0 60 60" fill="none" id="CheckCircle" xmlns="http://www.w3.org/2000/svg" class="check top">
                <path d="M40.3125 24.375L26.5547 37.5L19.6875 30.9375" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M30 52.5C42.4264 52.5 52.5 42.4264 52.5 30C52.5 17.5736 42.4264 7.5 30 7.5C17.5736 7.5 7.5 17.5736 7.5 30C7.5 42.4264 17.5736 52.5 30 52.5Z" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
    `}async function getShampoo(){var e,t=await(await fetch("assets/json/shampoo.json")).json(),o=document.querySelector(".shampoo_goods");for(e in t)o.innerHTML+=`
        <div data-id="${t[e].id}" class="goods-item">
            <img src=${t[e].url} alt="soap" class="goods-item--img">
            <h4 class="goods-item--title">${t[e].title}</h4>
            <p class="goods-item--text">${t[e].description}</p>
            <p class="goods-item--price"><span class="price firstPrice">${t[e].price}</span> <span>грн.</span></p>
            <svg class="plus">
                <use data-number="${t[e].id}" xlink:href="assets/img/sprite/symbol/sprite.svg#PlusCircle" class="goods-item--box"></use>
            </svg>
            <svg width="60" height="60" viewBox="0 0 60 60" fill="none" id="CheckCircle" xmlns="http://www.w3.org/2000/svg">
                <path d="M40.3125 24.375L26.5547 37.5L19.6875 30.9375" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M30 52.5C42.4264 52.5 52.5 42.4264 52.5 30C52.5 17.5736 42.4264 7.5 30 7.5C17.5736 7.5 7.5 17.5736 7.5 30C7.5 42.4264 17.5736 52.5 30 52.5Z" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        `}async function getBalmForHair(){var e,t=await(await fetch("assets/json/balm_for_hair.json")).json(),o=document.querySelector(".balm-hair_goods");for(e in t)o.innerHTML+=`
        <div data-id="${t[e].id}" class="goods-item">
            <img src=${t[e].url} alt="soap" class="goods-item--img">
            <h4 class="goods-item--title">${t[e].title}</h4>
            <p class="goods-item--text">${t[e].description}</p>
            <p class="goods-item--price"><span class="price firstPrice">${t[e].price}</span> <span>грн.</span></p>
            <svg class="plus">
                <use data-number="${t[e].id}" xlink:href="assets/img/sprite/symbol/sprite.svg#PlusCircle" class="goods-item--box"></use>
            </svg>
            <svg width="60" height="60" viewBox="0 0 60 60" fill="none" id="CheckCircle" xmlns="http://www.w3.org/2000/svg">
                <path d="M40.3125 24.375L26.5547 37.5L19.6875 30.9375" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M30 52.5C42.4264 52.5 52.5 42.4264 52.5 30C52.5 17.5736 42.4264 7.5 30 7.5C17.5736 7.5 7.5 17.5736 7.5 30C7.5 42.4264 17.5736 52.5 30 52.5Z" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        `}async function getDeodorant(){var e,t=await(await fetch("assets/json/deodorant.json")).json(),o=document.querySelector(".deodorant_goods");for(e in t)o.innerHTML+=`
        <div data-id="${t[e].id}" class="goods-item">
            <img src=${t[e].url} alt="soap" class="goods-item--img">
            <h4 class="goods-item--title">${t[e].title}</h4>
            <p class="goods-item--text">${t[e].description}</p>
            <p class="goods-item--price"><span class="price firstPrice">${t[e].price}</span> <span>грн.</span></p>
            <svg class="plus">
                <use data-number="${t[e].id}" xlink:href="assets/img/sprite/symbol/sprite.svg#PlusCircle" class="goods-item--box"></use>
            </svg>
            <svg width="60" height="60" viewBox="0 0 60 60" fill="none" id="CheckCircle" xmlns="http://www.w3.org/2000/svg">
                <path d="M40.3125 24.375L26.5547 37.5L19.6875 30.9375" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M30 52.5C42.4264 52.5 52.5 42.4264 52.5 30C52.5 17.5736 42.4264 7.5 30 7.5C17.5736 7.5 7.5 17.5736 7.5 30C7.5 42.4264 17.5736 52.5 30 52.5Z" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        `}async function getBalmForLips(){var e,t=await(await fetch("assets/json/balm_for_lips.json")).json(),o=document.querySelector(".balm-lips_goods");for(e in t)o.innerHTML+=`
        <div data-id="${t[e].id}" class="goods-item">
            <img src=${t[e].url} alt="soap" class="goods-item--img">
            <h4 class="goods-item--title">${t[e].title}</h4>
            <p class="goods-item--text">${t[e].description}</p>
            <p class="goods-item--price"><span class="price firstPrice">${t[e].price}</span> <span>грн.</span></p>
            <svg class="plus">
                <use data-number="${t[e].id}" xlink:href="assets/img/sprite/symbol/sprite.svg#PlusCircle" class="goods-item--box"></use>
            </svg>
            <svg width="60" height="60" viewBox="0 0 60 60" fill="none" id="CheckCircle" xmlns="http://www.w3.org/2000/svg">
                <path d="M40.3125 24.375L26.5547 37.5L19.6875 30.9375" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M30 52.5C42.4264 52.5 52.5 42.4264 52.5 30C52.5 17.5736 42.4264 7.5 30 7.5C17.5736 7.5 7.5 17.5736 7.5 30C7.5 42.4264 17.5736 52.5 30 52.5Z" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        `}async function getNews(){var e,t=await(await fetch("assets/json/news.json")).json(),o=document.querySelector(".news-goods");for(e in t)o.innerHTML+=`
        <div data-id="${t[e].id}" class="goods-item">
            <img src=${t[e].url} alt="soap" class="goods-item--img">
            <h4 class="goods-item--title">${t[e].title}</h4>
            <p class="goods-item--text">${t[e].description}</p>
            <p class="goods-item--price"><span class="price firstPrice">${t[e].price}</span> <span>грн.</span></p>
            <svg class="plus">
                <use data-number="${t[e].id}" xlink:href="assets/img/sprite/symbol/sprite.svg#PlusCircle" class="goods-item--box"></use>
            </svg>
            <svg width="60" height="60" viewBox="0 0 60 60" fill="none" id="CheckCircle" xmlns="http://www.w3.org/2000/svg">
                <path d="M40.3125 24.375L26.5547 37.5L19.6875 30.9375" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M30 52.5C42.4264 52.5 52.5 42.4264 52.5 30C52.5 17.5736 42.4264 7.5 30 7.5C17.5736 7.5 7.5 17.5736 7.5 30C7.5 42.4264 17.5736 52.5 30 52.5Z" stroke="black" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
        </div>
        `}const initialState=()=>{if(null!==localStorage.getItem("products")){popapGoods.innerHTML=localStorage.getItem("products"),printQuantity(),calcPrice(),productsBtn=document.querySelectorAll(".goods-item--box");var e,t=localStorage.getItem("id");for(e of JSON.parse(t))12===e||0===e?document.querySelectorAll(`.goods-item[data-id="${e}"]`).forEach(e=>{e.querySelector(".goods-item--box").classList.add("check")}):document.querySelector(`.goods-item[data-id="${e}"]`).querySelector(".goods-item--box").classList.add("check");localStorage.getItem("formData")&&(t=JSON.parse(localStorage.getItem("formData")),document.getElementById("name").value=t.name,document.getElementById("surname").value=t.surname,document.getElementById("tel").value=t.tel)}},updateStorage=()=>{let e=document.querySelector(".popap-goods").innerHTML;(e=e.trim()).length?localStorage.setItem("products",e):localStorage.removeItem("products")},validation=e=>{let s=!0;const a=(e,t)=>{var o=e.closest(".popapOrder-form--check"),s=document.createElement("label");s.classList.add("error-label"),s.textContent=t,e.classList.add("error"),o.append(s)};return e.querySelectorAll("input").forEach(e=>{var t,o;(t=e).classList.contains("error")&&(o=t.closest(".popapOrder-form--check").querySelector(".error-label"),t.classList.remove("error"),o.remove()),""==e.value&&(a(e,"Поле не заповнено"),s=!1),"tel"==e.type&&(t=e.value.trim(),/^\+?\d+$/.test(t)||(a(e,"Невірно внесені дані, вводити числа від 0 до 9"),s=!1)),"text"==e.type&&(o=e.value.trim(),/\d/.test(o))&&(a(e,"Невірно внесені дані, ім'я та прізвище не може містити літери"),s=!1)}),s};async function sendProducts(){document.querySelector(".popapOrder-form").addEventListener("submit",e=>{var s="";if(e.preventDefault(),validation(e.target)){let o=[];(cartItems=document.querySelectorAll(".popap-goods--item")).forEach(e=>{var t={};t.id=e.dataset.id,t.title=e.querySelector(".popap-goods--title").textContent,t.numbers=e.querySelector(".popap-goods--count_num").textContent,o.push(t)}),fullSum=document.querySelector(".total-sum");var e=e.currentTarget,t=new FormData(e),{name:t,surname:a,tel:r}=(t.append("price",fullSum.textContent),Object.fromEntries(t.entries()));s+=`<b>Ім'я</b> ${t}
<b>Прізвище</b> ${a}
<b>Телефон</b> ${r}
`,o.forEach(e=>{var t=e.id,o=e.title,e=e.numbers;s+=`<b>Код </b> ${t} <b>Назва товару </b> ${o} <b>К-сть </b> ${e}
`}),s+=`<b>Сума замовлення </b> ${fullSum.textContent} грн`;try{var i=fetch(API,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:chat_id,text:s,parse_mode:"HTML"})});if(!i.ok)throw new Error(i.statusText);console.log("Відправлено"),e.reset()}catch(e){}document.getElementById("name").value="",document.getElementById("surname").value="",document.getElementById("tel").value="",popapOrder.classList.remove("active"),popapOrderContent.classList.remove("active"),popapThanks.classList.add("active"),popapThanksContent.classList.add("active"),cartItems.forEach(e=>{e.remove()}),printQuantity();var c,t=localStorage.getItem("id");for(c of JSON.parse(t))12===c||0===c?document.querySelectorAll(`.goods-item[data-id="${c}"]`).forEach(e=>{e.querySelector(".goods-item--box").classList.remove("check")}):document.querySelector(`.goods-item[data-id="${c}"]`).querySelector(".goods-item--box").classList.remove("check");localStorage.removeItem("id"),localStorage.removeItem("products"),localStorage.removeItem("formData")}})}const saveProducts=()=>{document.querySelector(".popapOrder-form").addEventListener("input",()=>{var e={name:document.getElementById("name").value,surname:document.getElementById("surname").value,tel:document.getElementById("tel").value};localStorage.setItem("formData",JSON.stringify(e))})};async function order(){try{await getStars(),await getShampoo(),await getBalmForHair(),await getDeodorant(),await getBalmForLips(),await getNews(),Check(),basket(),links(),answers(),downList(),saveProducts(),await sendProducts(),popapFuction(quantity),initialState()}catch(e){}}order();